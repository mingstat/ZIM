<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to ZIM â€¢ ZIM</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to ZIM">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ZIM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/ZIM.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mingstat/ZIM/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to ZIM</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mingstat/ZIM/blob/HEAD/vignettes/ZIM.Rmd" class="external-link"><code>vignettes/ZIM.Rmd</code></a></small>
      <div class="hidden name"><code>ZIM.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mingstat/ZIM" class="external-link">ZIM</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">syph</span><span class="op">)</span></span>
<span><span class="va">count</span> <span class="op">&lt;-</span> <span class="va">syph</span><span class="op">$</span><span class="va">a33</span></span>
<span><span class="va">count.lag1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bshift.html">bshift</a></span><span class="op">(</span><span class="va">count</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">trend</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1000</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html" class="external-link">ts</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"Week"</span>, ylab <span class="op">=</span> <span class="st">"Number of Syphilis Cases"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Maryland (2007 - 2010)"</span>, type <span class="op">=</span> <span class="st">"o"</span>, pch <span class="op">=</span> <span class="fl">20</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="observation-driven-models">Observation-Driven Models<a class="anchor" aria-label="anchor" href="#observation-driven-models"></a>
</h2>
<div class="section level3">
<h3 id="zip-autoregression">ZIP Autoregression<a class="anchor" aria-label="anchor" href="#zip-autoregression"></a>
</h3>
<p>We first fit a ZIP autoregression with an AR(1) correlation
structure. The linear trend is included in both the log-linear and
logistic parts of the model.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/zim.html">zim</a></span><span class="op">(</span><span class="va">count</span> <span class="op">~</span> <span class="va">count.lag1</span> <span class="op">+</span> <span class="va">trend</span> <span class="op">|</span> <span class="va">trend</span><span class="op">)</span></span>
<span><span class="va">m1</span></span></code></pre></div>
<p>The EM-NR algorithm is used as the default algorithm in the zim
function.</p>
</div>
<div class="section level3">
<h3 id="zinb-autoregression">ZINB Autoregression<a class="anchor" aria-label="anchor" href="#zinb-autoregression"></a>
</h3>
<p>As suggested by the score test, we next fit a ZINB autoregression,
with all the other components remaining the same as in the ZIP
autoregression.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/zim.html">zim</a></span><span class="op">(</span><span class="va">count</span> <span class="op">~</span> <span class="va">count.lag1</span> <span class="op">+</span> <span class="va">trend</span> <span class="op">|</span> <span class="va">trend</span>, dist <span class="op">=</span> <span class="st">"zinb"</span><span class="op">)</span></span>
<span><span class="va">m2</span></span></code></pre></div>
<p>The AIC and TIC suggest a marginal improvement when the ZINB
autoregression is used. However, the BIC values for the ZIP and ZINB
autoregressions are not distinguishable. This should not be surprising
as BIC tends to penalize more for complexity.</p>
</div>
</div>
<div class="section level2">
<h2 id="parameter-driven-models">Parameter-Driven Models<a class="anchor" aria-label="anchor" href="#parameter-driven-models"></a>
</h2>
<div class="section level3">
<h3 id="dynamic-zip-model">Dynamic ZIP Model<a class="anchor" aria-label="anchor" href="#dynamic-zip-model"></a>
</h3>
<p>We now fit a dynamic ZIP model to the syphilis data. The trend is
included as a deterministic covariate in the log-linear model. The
zero-inflation parameter is assumed to be constant over time.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dzim.html">dzim</a></span><span class="op">(</span><span class="va">count</span> <span class="op">~</span> <span class="va">trend</span>, dist <span class="op">=</span> <span class="st">"zip"</span>, N <span class="op">=</span> <span class="fl">200</span>, R <span class="op">=</span> <span class="fl">200</span>, niter <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">m3</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dzim.plot.html">dzim.plot</a></span><span class="op">(</span><span class="va">m3</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="dynamic-zinb-model">Dynamic ZINB Model<a class="anchor" aria-label="anchor" href="#dynamic-zinb-model"></a>
</h3>
<p>We next fit a dynamic ZINB model to see whether a need remains for
the NB dispersion parameter.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">m4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dzim.html">dzim</a></span><span class="op">(</span><span class="va">count</span> <span class="op">~</span> <span class="va">trend</span>, dist <span class="op">=</span> <span class="st">"zinb"</span>, N <span class="op">=</span> <span class="fl">200</span>, R <span class="op">=</span> <span class="fl">200</span>, niter <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">m4</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dzim.plot.html">dzim.plot</a></span><span class="op">(</span><span class="va">m4</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Ming Yang, Gideon Zamba, Joseph Cavanaugh.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
